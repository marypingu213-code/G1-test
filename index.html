<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çœ‹åœ–å¥å­é‡çµ„</title>
    <style>
        body {
            font-family: "å¾®è»Ÿæ­£é»‘é«”", sans-serif;
            background-color: #fce4ec; /* æº«é¦¨çš„èƒŒæ™¯è‰² */
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            margin: 0;
            min-height: 100vh;
        }

        h1 { color: #880e4f; margin-bottom: 10px; }

        /* éŠæˆ²é€²åº¦æ¢ */
        #progress {
            margin-bottom: 15px;
            font-size: 1.2rem;
            color: #555;
            font-weight: bold;
        }

        /* åœ–ç‰‡é¡¯ç¤ºå€ */
        .image-container {
            background: white;
            padding: 10px;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            max-width: 90%;
        }

        #question-image {
            max-width: 100%;
            max-height: 300px;
            border-radius: 10px;
            display: block;
            min-height: 150px; 
            min-width: 200px;
            background-color: #eee; /* è¼‰å…¥å‰é¡¯ç¤ºæ·ºç°åº• */
        }

        /* ä½œç­”å€åŸŸï¼ˆç°è‰²åº•ï¼‰ */
        #answer-area {
            width: 90%;
            max-width: 800px;
            min-height: 80px;
            background-color: #e3f2fd;
            border: 2px dashed #2196F3;
            border-radius: 10px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            padding: 15px;
            margin-bottom: 20px;
            gap: 10px;
            transition: background-color 0.3s;
        }

        /* é¡Œç›®é¸é …å€åŸŸï¼ˆæ‰“äº‚çš„è©ï¼‰ */
        #options-area {
            width: 90%;
            max-width: 800px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
        }

        /* è©èªå¡ç‰‡æ¨£å¼ */
        .word-card {
            background-color: white;
            border: 2px solid #ff4081;
            color: #333;
            padding: 10px 20px;
            border-radius: 50px;
            font-size: 1.5rem;
            cursor: grab;
            user-select: none;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.2s, background-color 0.2s;
        }

        .word-card:hover {
            transform: scale(1.05);
            background-color: #fff0f5;
        }

        .word-card.dragging {
            opacity: 0.5;
            cursor: grabbing;
            background-color: #ccc;
        }

        /* æŒ‰éˆ•èˆ‡è¨Šæ¯ */
        .controls {
            display: flex;
            gap: 15px;
            flex-direction: column;
            align-items: center;
        }

        button {
            padding: 12px 40px;
            font-size: 1.3rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
            transition: transform 0.1s;
        }
        
        button:active { transform: translateY(4px); box-shadow: none; }

        #check-btn { background-color: #4CAF50; color: white; }
        #next-btn { background-color: #2196F3; color: white; display: none; } /* é è¨­éš±è—ä¸‹ä¸€é¡Œ */

        #message {
            font-size: 1.5rem;
            height: 30px;
            font-weight: bold;
        }
        .correct-msg { color: green; }
        .wrong-msg { color: red; }

    </style>
</head>
<body>

    <h1>çœ‹åœ–é‡çµ„å¥å­</h1>
    <div id="progress">æº–å‚™é–‹å§‹...</div>

    <div class="image-container">
        <img id="question-image" src="" alt="é¡Œç›®åœ–ç‰‡">
    </div>

    <div id="answer-area" class="drop-zone">
        </div>

    <div id="options-area" class="drop-zone">
        </div>

    <div id="message"></div>

    <div class="controls">
        <button id="check-btn" onclick="checkAnswer()">æª¢æŸ¥ç­”æ¡ˆ</button>
        <button id="next-btn" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ â”</button>
    </div>

    <script>
        // ============================================
        //  é¡Œç›®è¨­å®šå€
        // ============================================
        const questions = [
            { img: '1.png', text: 'æ³¡æ³¡ å¥½åƒ åœ¨ æŠ±æŠ±' },
            { img: '2.png', text: 'æˆ¿å­è£¡ æœ‰ æ»¿æ»¿çš„ å¹¸ç¦' },
            { img: '3.png', text: 'æˆ‘ æŠŠ ç´…ç´…çš„ æ»¿ è²¼åœ¨ å®¶è£¡' },
            { img: '4.png', text: 'é­šç¼¸è£¡ éƒ½æ˜¯ æ‚„æ‚„è©±' },
            { img: '5.png', text: 'é­šç¼¸è£¡ é–‹æ»¿ å¤§ ç´…èŠ±' },
            { img: '6.png', text: 'æˆ‘å€‘ ä½çš„ æ˜¯ åœ°çƒ' },
            { img: '7.png', text: 'å¤–æ˜Ÿäºº ä½  ä½åœ¨ å“ªå€‹ æ˜Ÿçƒ?' },
            { img: '8.png', text: 'æˆ‘ è¦ å’Œ ä»– åš æœ‹å‹' },
            { img: '9.png', text: 'åœ¨ é’é’çš„ å±±ä¸Š' },
            { img: '10.png', text: 'æˆ‘ å¤§å« ï¼š ä½ å¥½' }
        ];
        
        // ============================================
        //  ã€é—œéµä¿®æ”¹ã€‘
        //  å› ç‚ºä½ çš„åœ–ç‰‡è·Ÿç¶²é æ”¾åœ¨åŒä¸€å±¤ï¼Œé€™è£¡è¦æ”¹æˆç©ºå­—ä¸²
        // ============================================
        const folderPath = ''; 
        // ============================================

        let currentQIndex = 0;
        let currentWords = [];
        
        const imgEl = document.getElementById('question-image');
        const answerArea = document.getElementById('answer-area');
        const optionsArea = document.getElementById('options-area');
        const msgEl = document.getElementById('message');
        const nextBtn = document.getElementById('next-btn');
        const checkBtn = document.getElementById('check-btn');
        const progressEl = document.getElementById('progress');

        // åˆå§‹åŒ–ç¬¬ä¸€é¡Œ
        loadQuestion(currentQIndex);

        function loadQuestion(index) {
            // é‡ç½®ä»‹é¢
            answerArea.innerHTML = '';
            optionsArea.innerHTML = '';
            msgEl.textContent = '';
            msgEl.className = '';
            nextBtn.style.display = 'none';
            checkBtn.style.display = 'block';
            checkBtn.disabled = false;
            
            // å¦‚æœé¡Œç›®åšå®Œäº†
            if (index >= questions.length) {
                imgEl.style.display = 'none';
                progressEl.textContent = "æ­å–œï¼å…¨éƒ¨é¡Œç›®éƒ½å®Œæˆäº†ï¼";
                checkBtn.style.display = 'none';
                return;
            }

            // è¼‰å…¥åœ–ç‰‡èˆ‡é€²åº¦
            const q = questions[index];
            imgEl.src = folderPath + q.img;
            imgEl.style.display = 'block';
            progressEl.textContent = `ç¬¬ ${index + 1} é¡Œ / å…± ${questions.length} é¡Œ`;

            // è™•ç†æ–‡å­—
            currentWords = q.text.split(' ').filter(Boolean); 

            // è¤‡è£½ä¸€ä»½ä¸¦æ‰“äº‚
            let shuffledWords = [...currentWords];
            shuffleArray(shuffledWords);

            // å»ºç«‹è©èªå¡ç‰‡
            shuffledWords.forEach(word => {
                const card = createWordCard(word);
                optionsArea.appendChild(card);
            });
        }

        function createWordCard(text) {
            const div = document.createElement('div');
            div.className = 'word-card';
            div.textContent = text;
            div.draggable = true;

            // æ‹–æ›³äº‹ä»¶
            div.addEventListener('dragstart', () => div.classList.add('dragging'));
            div.addEventListener('dragend', () => div.classList.remove('dragging'));
            
            // é»æ“Šç§»å‹•
            div.addEventListener('click', () => {
                if (div.parentElement === optionsArea) {
                    answerArea.appendChild(div);
                } else {
                    optionsArea.appendChild(div);
                }
            });

            return div;
        }

        // æª¢æŸ¥ç­”æ¡ˆ
        function checkAnswer() {
            const answerCards = answerArea.querySelectorAll('.word-card');
            const studentAnswer = Array.from(answerCards).map(card => card.textContent).join('');
            const correctAnswer = currentWords.join('');

            if (studentAnswer === correctAnswer) {
                msgEl.textContent = 'ğŸ‰ ç­”å°äº†ï¼ä½ å¥½æ£’ï¼';
                msgEl.className = 'correct-msg';
                checkBtn.style.display = 'none';
                nextBtn.style.display = 'block'; 
                
                answerCards.forEach(c => c.draggable = false);
            } else {
                msgEl.textContent = 'âŒ å†è©¦è©¦çœ‹ï¼Œé †åºå¥½åƒä¸å°å–”ï¼';
                msgEl.className = 'wrong-msg';
            }
        }

        function nextQuestion() {
            currentQIndex++;
            loadQuestion(currentQIndex);
        }

        // --- æ‹–æ”¾åŠŸèƒ½æ ¸å¿ƒé‚è¼¯ ---
        const dropZones = [answerArea, optionsArea];

        dropZones.forEach(zone => {
            zone.addEventListener('dragover', e => {
                e.preventDefault();
                const afterElement = getDragAfterElement(zone, e.clientX, e.clientY);
                const draggable = document.querySelector('.dragging');
                if (afterElement == null) {
                    zone.appendChild(draggable);
                } else {
                    zone.insertBefore(draggable, afterElement);
                }
            });
        });

        function getDragAfterElement(container, x, y) {
            const draggableElements = [...container.querySelectorAll('.word-card:not(.dragging)')];

            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offsetX = x - box.left - box.width / 2;
                const offsetY = y - box.top - box.height / 2;
                
                if (offsetX < 0 && offsetX > closest.offset) {
                    return { offset: offsetX, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

    </script>
</body>
</html>
